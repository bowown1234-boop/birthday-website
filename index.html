<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>Happy Birthday</title>

    <!-- ‡∏ü‡∏≠‡∏ô‡∏ï‡πå -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Sacramento&display=swap"
        rel="stylesheet"
    />

    <style>
        * ,
        *::before,
        *::after {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            font-family: "Prompt", system-ui, -apple-system, BlinkMacSystemFont,
                "Segoe UI", sans-serif;
            background: #fff7fb;
            color: #3b2940;
            /* ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö safe area ‡∏Ç‡∏≠‡∏á iPhone */
            padding: env(safe-area-inset-top)
                     env(safe-area-inset-right)
                     env(safe-area-inset-bottom)
                     env(safe-area-inset-left);
        }

        #app {
            /* ‡πÉ‡∏ä‡πâ vh ‡πÅ‡∏ö‡∏ö‡πÅ‡∏Å‡πâ‡∏ö‡∏±‡πä‡∏Å‡∏ö‡∏ô iPhone */
            min-height: calc(var(--vh, 1vh) * 100);
            display: flex;
            justify-content: center;
            align-items: stretch;
        }

        .page {
            display: none;
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
            padding: 20px 16px 26px;

            opacity: 0;
            transform: translateY(16px) scale(0.97);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .page.active {
            display: block;
        }

        .page.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .page-inner {
            background: #ffffff;
            border-radius: 24px;
            padding: 22px 18px 26px;
            box-shadow: 0 10px 30px rgba(219, 137, 180, 0.16);
            min-height: calc(100vh - 60px);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .title {
            font-weight: 600;
            font-size: 1.4rem;
            text-align: center;
            margin: 16px 0 6px;
            color: #3b2940;
        }

        .subtitle {
            font-size: 0.95rem;
            text-align: center;
            color: #9b6b8c;
            margin-bottom: 18px;
        }

        .avatar {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #ffd7e5;
            box-shadow: 0 6px 20px rgba(219, 137, 180, 0.35);
        }

        .avatar.large {
            width: 160px;
            height: 160px;
            margin-bottom: 14px;
        }

        .code-display {
            margin-top: 16px;
            margin-bottom: 12px;
            padding: 10px 16px;
            border-radius: 999px;
            border: 1px dashed #f2b3c8;
            width: 80%;
            max-width: 260px;
            text-align: center;
            letter-spacing: 0.3em;
            font-weight: 600;
            font-size: 1.1rem;
            color: #3b2940;
            background: #fff8fb;
        }

        .code-display.error {
            animation: shake 0.35s;
            border-color: #ff7b9a;
            background: #ffe6ee;
        }

        .keypad {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 10px;
            width: 100%;
            max-width: 320px;
            margin-top: 10px;
        }

        .key {
            border: none;
            border-radius: 16px;
            padding: 12px 0;
            font-size: 1.2rem;
            font-weight: 500;
            background: #ffe2f0;
            color: #4b304f;
            box-shadow: 0 4px 10px rgba(219, 137, 180, 0.3);
            cursor: pointer;
            transition: transform 0.08s ease, box-shadow 0.12s ease,
                background 0.12s;
            touch-action: manipulation; /* ‡∏Å‡∏±‡∏ô‡∏ã‡∏π‡∏°‡∏ï‡∏≠‡∏ô‡πÅ‡∏ï‡∏∞‡∏£‡∏±‡∏ß ‡πÜ */
        }

        .key:active {
            transform: translateY(2px) scale(0.98);
            box-shadow: 0 2px 5px rgba(219, 137, 180, 0.25);
            background: #ffd3ea;
        }

        .key-func {
            font-size: 0.95rem;
            background: #f7d0ff;
        }

        .hint {
            margin-top: 10px;
            font-size: 0.8rem;
            color: #c08ab0;
            text-align: center;
        }

        .primary-btn {
            border: none;
            border-radius: 999px;
            padding: 12px 26px;
            font-size: 1rem;
            font-weight: 600;
            background: linear-gradient(135deg, #ff9ac5, #ffb5de);
            color: #fff;
            box-shadow: 0 10px 25px rgba(255, 141, 188, 0.42);
            margin-top: 20px;
            cursor: pointer;
            transition: transform 0.1s ease, box-shadow 0.12s ease;
            touch-action: manipulation;
        }

        .primary-btn:active {
            transform: translateY(2px);
            box-shadow: 0 6px 15px rgba(255, 141, 188, 0.35);
        }

        /* ‡πÄ‡∏Ñ‡πâ‡∏Å */
        .cake {
            margin-top: 16px;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .cake-top {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 6px;
        }

        .candle {
            width: 10px;
            height: 40px;
            background: #ffe0f4;
            border-radius: 5px;
            position: relative;
        }

        .flame {
            width: 12px;
            height: 18px;
            background: radial-gradient(
                circle at 30% 30%,
                #fff7b1,
                #ff9d6c
            );
            border-radius: 50%;
            position: absolute;
            top: -16px;
            left: 50%;
            transform: translateX(-50%);
            animation: flicker 0.6s infinite alternate;
        }

        .cake-body {
            width: 180px;
            height: 70px;
            background: linear-gradient(180deg, #ffd0e7, #ffadc7);
            border-radius: 18px;
            position: relative;
            overflow: hidden;
        }

        .cake-body::before {
            content: "";
            position: absolute;
            width: 200%;
            height: 18px;
            background: repeating-linear-gradient(
                45deg,
                #ffe5f3 0,
                #ffe5f3 8px,
                #ffc4d8 8px,
                #ffc4d8 16px
            );
            top: 0;
            left: -50%;
        }

        .cake-plate {
            width: 210px;
            height: 16px;
            background: #f9f5ff;
            border-radius: 999px;
            margin-top: 6px;
            box-shadow: 0 4px 10px rgba(202, 168, 209, 0.35);
        }

        .cake.blown .flame {
            opacity: 0;
            animation: none;
        }

        .cake.blown .cake-body::after {
            content: "";
            position: absolute;
            width: 120px;
            height: 40px;
            top: -18px;
            left: 50%;
            transform: translateX(-50%);
            background: radial-gradient(
                circle,
                rgba(255, 255, 255, 0.8),
                transparent
            );
            opacity: 0;
            animation: smoke 1.2s forwards;
        }

        /* ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç */
        .gift-wrapper {
            margin-top: 10px;
            margin-bottom: 8px;
        }

        .gift-box {
            width: 130px;
            height: 110px;
            position: relative;
            cursor: pointer;
            animation: gift-breath 1.5s ease-in-out infinite;
        }

        .gift-lid {
            position: absolute;
            width: 130px;
            height: 34px;
            background: #ffb3cd;
            border-radius: 10px 10px 4px 4px;
            top: 0;
            box-shadow: 0 4px 10px rgba(255, 161, 199, 0.45);
        }

        .gift-body {
            position: absolute;
            width: 130px;
            height: 85px;
            background: #ffcfdf;
            border-radius: 4px 4px 12px 12px;
            bottom: 0;
            box-shadow: 0 8px 18px rgba(238, 130, 171, 0.35);
        }

        .gift-ribbon-vertical,
        .gift-ribbon-horizontal {
            position: absolute;
            background: #ff7ba8;
        }

        .gift-ribbon-vertical {
            width: 14px;
            height: 100%;
            left: 50%;
            transform: translateX(-50%);
        }

        .gift-ribbon-horizontal {
            height: 14px;
            width: 100%;
            top: 32px;
        }

        .gift-box.shake {
            animation: gift-shake 0.3s ease;
        }

        .gift-box.opened .gift-lid {
            animation: lid-open 0.5s forwards;
        }

        .gift-content {
            margin-top: 18px;
            text-align: center;
            display: none;
        }

        .gift-content.show {
            display: block;
        }

        .wish-text {
            font-size: 0.95rem;
            color: #5a355f;
            line-height: 1.6;
            margin: 10px 0 4px;
        }

        /* ‡∏´‡∏ô‡πâ‡∏≤ 4 */
        .love-list {
            margin-top: 8px;
            padding-left: 20px;
            font-size: 0.95rem;
            color: #4b304f;
            line-height: 1.7;
            align-self: stretch;
        }

        .love-list li + li {
            margin-top: 6px;
        }

        /* ‡∏´‡∏ô‡πâ‡∏≤ 5 : ‡∏™‡∏°‡∏∏‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ + 3 ‡∏Ñ‡∏•‡∏¥‡∏õ */
        .book-wrapper {
            margin-top: 14px;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .book {
            position: relative;
            width: 100%;
            max-width: 320px;
            height: 210px;
            background: #ffeef7;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(219, 137, 180, 0.35);
            display: flex;
            overflow: hidden;
        }

        .book-left,
        .book-right {
            flex: 1;
            padding: 14px 10px;
            position: relative;
        }

        .book-left {
            background: linear-gradient(135deg, #ffeef9, #ffe1f3);
            border-right: 1px solid rgba(255, 255, 255, 0.8);
        }

        .book-right {
            background: #fff7fc;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .book-spine {
            position: absolute;
            width: 10px;
            top: 0;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            background: radial-gradient(circle, #f6c1da, #f19ec2);
            box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.12);
        }

        .chapter-label {
            font-size: 0.85rem;
            color: #b26a98;
            margin-bottom: 6px;
        }

        .chapter-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #5b355f;
            margin-bottom: 10px;
        }

        .chapter-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .chapter-list li {
            font-size: 0.85rem;
            color: #714066;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .chapter-dot {
            width: 6px;
            height: 6px;
            border-radius: 999px;
            background: #ff8fb8;
        }

        .book-video {
            width: 100%;
            height: 100%;
            border-radius: 12px;
            background: #000;
            object-fit: cover;
        }

        .book-tabs {
            width: 100%;
            max-width: 320px;
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 10px;
        }

        .tab-btn {
            border: none;
            border-radius: 999px;
            padding: 6px 14px;
            font-size: 0.8rem;
            background: #ffe0f2;
            color: #744067;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(219, 137, 180, 0.3);
            transition: background 0.15s ease, transform 0.1s ease,
                box-shadow 0.12s ease;
            touch-action: manipulation;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #ff9ac5, #ffb5de);
            color: #fff;
            transform: translateY(-1px);
            box-shadow: 0 6px 14px rgba(255, 141, 188, 0.5);
        }

        .tab-btn:active {
            transform: translateY(1px);
            box-shadow: 0 3px 8px rgba(219, 137, 180, 0.35);
        }

        /* ‡∏´‡∏ô‡πâ‡∏≤ 6 (‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢) */
        .last-page {
            justify-content: flex-start;
            padding-top: 10px;
        }

        .last-message-label {
            font-size: 0.92rem;
            color: #c08ab0;
            margin-bottom: 8px;
        }

        .last-message {
            font-family: "Sacramento", cursive;
            font-size: 2rem;
            text-align: center;
            color: #f074a2;
            line-height: 1.4;
            margin-bottom: 6px;
        }

        .last-sign {
            font-size: 1rem;
            color: #7b4b7f;
        }

        /* ‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ ‡∏´‡∏ô‡πâ‡∏≤ 6 */
        .memory-gallery {
            margin-top: 8px;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .memory-image {
            width: 100%;
            max-width: 260px;
            border-radius: 18px;
            object-fit: cover;
            box-shadow: 0 10px 25px rgba(219, 137, 180, 0.35);
            opacity: 0;
            transform: scale(0.96);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .memory-image.show {
            opacity: 1;
            transform: scale(1);
        }

        /* ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏•‡∏≠‡∏¢ */
        #hearts-container {
            position: fixed;
            inset: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 999;
        }

        .heart {
            position: absolute;
            font-size: 16px;
            color: #ff8fb8;
            opacity: 0;
            animation: float-heart 1.5s linear forwards;
        }

        /* ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô */
        @keyframes float-heart {
            0% {
                transform: translateY(0) scale(0.7);
                opacity: 0;
            }
            15% {
                opacity: 1;
            }
            100% {
                transform: translateY(-70px) scale(1.1);
                opacity: 0;
            }
        }

        @keyframes shake {
            0% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-4px);
            }
            50% {
                transform: translateX(4px);
            }
            75% {
                transform: translateX(-3px);
            }
            100% {
                transform: translateX(0);
            }
        }

        @keyframes flicker {
            from {
                transform: translateX(-50%) scale(1);
                opacity: 0.9;
            }
            to {
                transform: translateX(-50%) scale(1.08);
                opacity: 1;
            }
        }

        @keyframes smoke {
            0% {
                opacity: 0;
                transform: translate(-50%, 0);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -18px);
            }
        }

        @keyframes gift-breath {
            0%,
            100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-4px);
            }
        }

        @keyframes gift-shake {
            0% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-4px) rotate(-2deg);
            }
            50% {
                transform: translateX(4px) rotate(2deg);
            }
            75% {
                transform: translateX(-2px) rotate(-1deg);
            }
            100% {
                transform: translateX(0) rotate(0);
            }
        }

        @keyframes lid-open {
            0% {
                transform: translateY(0) rotate(0);
            }
            100% {
                transform: translate(-10px, -34px) rotate(-18deg);
                opacity: 0.9;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- ‡∏´‡∏ô‡πâ‡∏≤ 1 -->
        <section class="page active" id="page-1">
            <div class="page-inner">
                <img src="images/fan-1.png" alt="‡πÅ‡∏ü‡∏ô" class="avatar" />

                <h1 class="title">‡πÉ‡∏™‡πà‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏û‡∏µ‡πà‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö</h1>
                <p class="subtitle">‡πÅ‡∏ï‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏•‡∏¢‡∏¢‡∏¢ üíó</p>

                <div class="code-display" id="code-display">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>

                <div class="keypad">
                    <button class="key" data-num="1">1</button>
                    <button class="key" data-num="2">2</button>
                    <button class="key" data-num="3">3</button>
                    <button class="key" data-num="4">4</button>
                    <button class="key" data-num="5">5</button>
                    <button class="key" data-num="6">6</button>
                    <button class="key" data-num="7">7</button>
                    <button class="key" data-num="8">8</button>
                    <button class="key" data-num="9">9</button>
                    <button class="key key-func" id="clear-btn">‡∏•‡∏ö</button>
                    <button class="key" data-num="0">0</button>
                    <button class="key key-func" id="ok-btn">‡∏ï‡∏Å‡∏•‡∏á</button>
                </div>

                <p class="hint">
                    ‡∏à‡∏∞‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≤‡∏≤‡∏≤‡∏≤‡∏≤ ü§ç
                </p>
            </div>
        </section>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤ 2 -->
        <section class="page" id="page-2">
            <div class="page-inner">
                <h1 class="title">‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏û‡∏£‡∏™‡πå!!!</h1>
                <h2 class="title">‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô‡πÄ‡πÄ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡πà‡∏≤‡πÄ‡∏Ñ‡πâ‡∏Å‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏öüéÇ</h2>
                <p class="subtitle">
                    ‡πÅ‡∏ï‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πà‡∏≤‡πÄ‡∏Ñ‡πâ‡∏Å
                </p>
                <p class="subtitle">
                    ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö
                </p>

                <div class="cake" id="cake">
                    <div class="cake-top">
                        <div class="candle">
                            <div class="flame"></div>
                        </div>
                        <div class="candle">
                            <div class="flame"></div>
                        </div>
                        <div class="candle">
                            <div class="flame"></div>
                        </div>
                    </div>
                    <div class="cake-body"></div>
                    <div class="cake-plate"></div>
                </div>

                <button class="primary-btn" id="blow-btn">‡πÄ‡∏õ‡πà‡∏≤‡πÄ‡∏Ñ‡πâ‡∏Å üí®</button>
            </div>
        </section>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤ 3 -->
        <section class="page" id="page-3">
            <div class="page-inner">
                <h1 class="title">‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡πÄ‡∏•‡∏¢!!! üéÅ</h1>
                <p class="subtitle">‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡πÄ‡∏ö‡∏≤ ‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö</p>

                <div class="gift-wrapper">
                    <div class="gift-box" id="gift-box">
                        <div class="gift-lid"></div>
                        <div class="gift-body"></div>
                        <div class="gift-ribbon-vertical"></div>
                        <div class="gift-ribbon-horizontal"></div>
                    </div>
                </div>

                <div class="gift-content" id="gift-content">
                    <img
                        src="images/fan-2.jpg"
                        alt="‡πÅ‡∏ü‡∏ô"
                        class="avatar large"
                    />
                    <p class="wish-text">
                        ‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡πÄ‡∏Å‡πà‡∏á ‡∏ô‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÑ‡∏î‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏Å‡πà‡∏á‡πÜ ‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ
                        ‡∏à‡∏ô‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ó‡∏≥‡πÑ‡∏î‡πâ ü§ç
                    </p>
                    <button class="primary-btn" id="to-page-4-btn">
                        ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ûúüíó
                    </button>
                </div>
            </div>
        </section>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤ 4 -->
        <section class="page" id="page-4">
            <div class="page-inner">
                <h1 class="title"> 6 ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏µ‡πà </h1>
                <p class="subtitle">
                    ‡∏≠‡πà‡∏≤‡∏ô‡∏î‡∏π‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏¢‡∏¢ üíå
                </p>

                <ol class="love-list">
                    <li>‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏´‡∏ô‡∏±‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏Ñ‡∏£‡πÜ</li>
                    <li>‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏®‡∏¥‡∏•‡∏õ‡∏∞ ‡∏ä‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå‡∏Ç‡∏≠‡∏á</li>
                    <li>‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡πÜ ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ï‡∏•‡∏≠‡∏î</li>
                    <li>‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏™‡∏π‡πâ‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡∏î‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠</li>
                    <li>‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏•‡∏¢‡∏¢‡∏¢</li>
                    <li>‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏™‡∏ß‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô ü§ç </li>
                </ol>

                <button class="primary-btn" id="to-page-5-btn">
                    ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ûúüéûÔ∏è
                </button>
            </div>
        </section>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤ 5 : ‡∏™‡∏°‡∏∏‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ + 3 ‡∏Ñ‡∏•‡∏¥‡∏õ -->
        <section class="page" id="page-5">
            <div class="page-inner">
                <h1 class="title">‡∏™‡∏°‡∏∏‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ üìñ</h1>
                <p class="subtitle">
                    ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ üíó
                </p>

                <div class="book-wrapper">
                    <div class="book">
                        <div class="book-left">
                            <div class="chapter-label">‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥</div>
                            <div class="chapter-title">‡∏™‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
                            <ul class="chapter-list">
                                <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏™‡πà‡∏à‡∏≤‡∏Å JS -->
                            </ul>
                        </div>
                        <div class="book-spine"></div>
                        <div class="book-right">
                            <video
                                id="book-video"
                                class="book-video"
                                controls
                                playsinline
                                webkit-playsinline
                            >
                                <source src="videos/memory1.mp4" type="video/mp4" />
                                ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ
                            </video>
                        </div>
                    </div>
                </div>

                <div class="book-tabs">
                    <button class="tab-btn active" data-vid="0">‡∏´‡∏ô‡πâ‡∏≤ 1</button>
                    <button class="tab-btn" data-vid="1">‡∏´‡∏ô‡πâ‡∏≤ 2</button>
                    <button class="tab-btn" data-vid="2">‡∏´‡∏ô‡πâ‡∏≤ 3</button>
                </div>

                <button class="primary-btn" id="to-page-6-btn" style="margin-top: 18px;">
                    ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ üíñ
                </button>
            </div>
        </section>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤ 6 : ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ -->
        <section class="page" id="page-6">
            <div class="page-inner last-page">
                <p class="last-message-label">‡∏à‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏á‡∏ñ‡∏∂‡∏á‡∏û‡∏µ‡πà</p>
                <p class="last-message">
                    ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö
                    ‡∏£‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏•‡∏¢‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏à‡∏ö‡∏à‡∏≤‡∏Å‡∏à‡∏µ‡∏ô
                    ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞
                </p>
                <p class="last-sign">‡∏£‡∏±‡∏Å‡∏û‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö üíñ</p>

                <!-- ‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏£‡∏π‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ -->
                <div class="memory-gallery">
                    <img
                        id="memory-image"
                        src="images/memory1.jpg"
                        alt="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤"
                        class="memory-image"
                    />
                </div>

                <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
                <button class="primary-btn" id="replay-btn" style="margin-top: 18px;">
                    ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà
                </button>
            </div>
        </section>
    </div>

    <!-- ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏•‡∏≠‡∏¢ -->
    <div id="hearts-container"></div>

    <!-- ‡πÄ‡∏™‡∏µ‡∏¢‡∏á -->
    <audio
        id="click-sound"
        src="audio/cute-click.wav"
        preload="auto"
    ></audio>
    <audio
        id="birthday-song"
        src="audio/happy-birthday.mp3"
        preload="auto"
        loop
    ></audio>
    <audio
        id="gift-song"
        src="audio/gift-song.mp3"
        preload="auto"
        loop
    ></audio>
    <audio
        id="love-song"
        src="audio/love-song.mp3"
        preload="auto"
        loop
    ></audio>

    <!-- ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠ 1 ‡πÅ‡∏•‡∏∞ 2 -->
    <audio
        id="gift-open-sound"
        src="audio/gift-open.wav"
        preload="auto"
    ></audio>
    <audio
        id="pageflip-sound"
        src="audio/pageflip.wav"
        preload="auto"
    ></audio>

    <script>
        // ‡πÅ‡∏Å‡πâ‡∏ö‡∏±‡πä‡∏Å 100vh ‡∏ö‡∏ô iPhone
        function setVh() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', vh + 'px');
        }
        setVh();
        window.addEventListener('resize', setVh);
        window.addEventListener('orientationchange', setVh);

        const CORRECT_CODE = "261147";
        let inputCode = "";

        const pages = document.querySelectorAll(".page");
        const codeDisplay = document.getElementById("code-display");
        const keypadButtons = document.querySelectorAll(".key[data-num]");
        const clearBtn = document.getElementById("clear-btn");
        const okBtn = document.getElementById("ok-btn");

        const clickSound = document.getElementById("click-sound");
        const birthdaySong = document.getElementById("birthday-song");
        const giftSong = document.getElementById("gift-song");
        const loveSong = document.getElementById("love-song");

        const giftOpenSound = document.getElementById("gift-open-sound");
        const pageflipSound = document.getElementById("pageflip-sound");

        const heartsContainer = document.getElementById("hearts-container");

        const cake = document.getElementById("cake");
        const blowBtn = document.getElementById("blow-btn");

        const giftBox = document.getElementById("gift-box");
        const giftContent = document.getElementById("gift-content");
        const toPage4Btn = document.getElementById("to-page-4-btn");
        const toPage5Btn = document.getElementById("to-page-5-btn");
        const toPage6Btn = document.getElementById("to-page-6-btn");
        const replayBtn = document.getElementById("replay-btn");

        const memoryImage = document.getElementById("memory-image");

        /* ‡∏™‡∏°‡∏∏‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ */
        const bookVideo   = document.getElementById("book-video");
        const tabButtons  = document.querySelectorAll(".tab-btn");
        const chapterLabel = document.querySelector(".chapter-label");
        const chapterTitle = document.querySelector(".chapter-title");
        const chapterList  = document.querySelector(".chapter-list");

        const bookVideos = [
            "videos/memory1.mp4",
            "videos/memory2.mp4",
            "videos/memory3.mp4"
        ];

        const bookTexts = [
            {
                label: "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 1 : ‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÇ‡∏î‡∏ô‡∏û‡∏µ‡πà‡∏ï‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏±‡∏á‡πÜ",
                title: "‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å ‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Å‡∏±‡∏ô",
                lines: [
                    "‡∏ï‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏à‡∏≠‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà‡∏û‡∏µ‡πà‡∏•‡∏á‡∏Ñ‡∏∑‡∏≠‡πÄ‡πÄ‡∏ö‡∏ö‡∏ä‡∏≠‡∏ö‡∏à‡∏±‡∏á‡πÜ"
                ]
            },
            {
                label: "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2 : ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏≠‡∏ö‡∏°‡∏≤‡∏Å‡πÜ",
                title: "‡∏ß‡∏±‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©",
                lines: [
                    "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏Å‡∏±‡∏ö‡∏û‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡πÉ‡∏Å‡∏•‡πâ‡πÜ‡∏Å‡∏±‡∏ô‡∏≠‡∏∏‡πà‡∏ô‡∏°‡∏≤‡∏Å‡πÜ"
                ]
            },
            {
                label: "‡∏ö‡∏ó‡∏ó‡∏µ‡πà 3 : ‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏°‡∏≤‡πÉ‡∏´‡πâ",
                title: "‡∏û‡∏≠‡πÄ‡∏´‡πá‡∏ô‡∏û‡∏µ‡πà‡∏î‡∏µ‡πÉ‡∏à‡πÉ‡∏´‡∏ç‡πà‡∏ô‡πâ‡∏≠‡∏á‡∏Å‡πá‡∏î‡∏µ‡πÉ‡∏à‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢",
                lines: [
                    "‡∏ï‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏¥‡∏ö‡∏¥‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏û‡∏µ‡πà ‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡πÇ‡∏ó‡πÇ‡∏ó‡πÇ‡∏£‡πà‡πÅ‡∏ï‡πà‡πÑ‡∏î‡πâ‡∏à‡∏µ‡∏à‡∏µ‡πâ‡πÅ‡∏ó‡∏ô"
                ]
            }
        ];

        let currentBookIndex = 0;

        /* ‡∏™‡πÑ‡∏•‡∏î‡πå‡πÇ‡∏ä‡∏ß‡πå‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ */
        const memoryImages = [
            "images/memory1.jpg",
            "images/memory2.jpg",
            "images/memory3.jpg",
            "images/memory4.jpg",
            "images/memory5.jpg",
            "images/memory6.jpg",
            "images/memory7.jpg",
            "images/memory8.jpg",
            "images/memory9.png",
            "images/memory10.jpg",
            "images/memory11.jpg",
            "images/memory12.jpg",
            "images/memory13.jpg",
            "images/memory14.jpg",
            "images/memory15.jpg"
        ];

        let memoryIndex = 0;
        let memorySlideStarted = false;
        let memoryIntervalId = null;

        function startMemorySlideshow() {
            if (!memoryImage || memorySlideStarted || memoryImages.length === 0) return;
            memorySlideStarted = true;

            memoryImage.src = memoryImages[0];
            memoryImage.classList.add("show");

            memoryIntervalId = setInterval(() => {
                memoryIndex = (memoryIndex + 1) % memoryImages.length;

                memoryImage.classList.remove("show");
                void memoryImage.offsetWidth; // force reflow
                memoryImage.src = memoryImages[memoryIndex];
                memoryImage.classList.add("show");
            }, 3000);
        }

        function stopAllSongs() {
            [birthdaySong, giftSong, loveSong].forEach((audio) => {
                if (!audio) return;
                audio.pause();
                audio.currentTime = 0;
            });
        }

        function playClick() {
            if (!clickSound) return;
            clickSound.currentTime = 0;
            clickSound.play().catch(() => {});
        }

        function playSound(el) {
            if (!el) return;
            el.currentTime = 0;
            el.play().catch(() => {});
        }

        // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤
        function goToPage(pageNumber) {
            const target = document.getElementById("page-" + pageNumber);
            if (!target) return;

            pages.forEach((p) => p.classList.remove("active", "show"));
            target.classList.add("active");

            requestAnimationFrame(() => {
                target.classList.add("show");
            });

            if (pageNumber === 2) {
                stopAllSongs();
                birthdaySong.currentTime = 0;
                birthdaySong.play().catch(() => {});
            } else if (pageNumber === 6) {
                startMemorySlideshow();
            }
        }

        function updateCodeDisplay() {
            if (inputCode.length === 0) {
                codeDisplay.textContent = "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ";
                return;
            }
            const dots = "‚Ä¢".repeat(inputCode.length);
            codeDisplay.textContent = dots.padEnd(6, " ");
        }

        function spawnHeart(x, y) {
            const heart = document.createElement("span");
            heart.classList.add("heart");
            heart.textContent = "‚ù§";

            const rect = heartsContainer.getBoundingClientRect();
            heart.style.left =
                x - rect.left + (Math.random() * 16 - 8) + "px";
            heart.style.top = y - rect.top + "px";
            heart.style.fontSize = 14 + Math.random() * 6 + "px";

            heartsContainer.appendChild(heart);

            setTimeout(() => {
                if (heart.parentNode) {
                    heart.parentNode.removeChild(heart);
                }
            }, 1500);
        }

        // ‡∏´‡∏ô‡πâ‡∏≤ 1: ‡∏Å‡∏î‡∏£‡∏´‡∏±‡∏™
        keypadButtons.forEach((btn) => {
            btn.addEventListener("click", (e) => {
                if (inputCode.length >= 6) return;
                const num = btn.getAttribute("data-num");
                inputCode += num;
                updateCodeDisplay();

                playClick();

                const rect = e.target.getBoundingClientRect();
                spawnHeart(
                    rect.left + rect.width / 2,
                    rect.top + rect.height / 2
                );
            });
        });

        clearBtn.addEventListener("click", () => {
            playClick();

            // ‡∏•‡∏ö‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤
            if (inputCode.length > 0) {
                inputCode = inputCode.slice(0, -1);
                updateCodeDisplay();
            }
        });

        okBtn.addEventListener("click", () => {
            playClick();
            if (inputCode === CORRECT_CODE) {
                inputCode = "";
                updateCodeDisplay();
                goToPage(2);
            } else {
                codeDisplay.classList.add("error");
                setTimeout(() => {
                    codeDisplay.classList.remove("error");
                }, 350);
                inputCode = "";
                updateCodeDisplay();
            }
        });

        // ‡∏´‡∏ô‡πâ‡∏≤ 2: ‡πÄ‡∏õ‡πà‡∏≤‡πÄ‡∏Ñ‡πâ‡∏Å
        if (blowBtn) {
            blowBtn.addEventListener("click", () => {
                playClick();

                if (cake) {
                    cake.classList.add("blown");
                }

                setTimeout(() => {
                    goToPage(3);
                }, 1500);
            });
        }

        // ‡∏´‡∏ô‡πâ‡∏≤ 3: ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç
        if (giftBox) {
            giftBox.addEventListener("click", () => {
                playClick();

                if (!giftBox.classList.contains("opened")) {
                    // ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
                    playSound(giftOpenSound);
                }

                giftBox.classList.add("shake");
                setTimeout(
                    () => giftBox.classList.remove("shake"),
                    300
                );

                giftBox.classList.add("opened");

                if (giftContent) {
                    giftContent.classList.add("show");
                }
            });
        }

        if (toPage4Btn) {
            toPage4Btn.addEventListener("click", () => {
                playClick();
                goToPage(4);
            });
        }

        if (toPage5Btn) {
            toPage5Btn.addEventListener("click", () => {
                playClick();
                goToPage(5);
            });
        }

        if (toPage6Btn) {
            toPage6Btn.addEventListener("click", () => {
                playClick();
                goToPage(6);
            });
        }

        /* ‡∏™‡∏°‡∏∏‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ + ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
        function setBookVideo(index, autoplay = true) {
            if (!bookVideo) return;
            currentBookIndex = index;

            // ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ó‡πá‡∏ö
            tabButtons.forEach((btn) => btn.classList.remove("active"));
            const activeBtn = document.querySelector(`.tab-btn[data-vid="${index}"]`);
            if (activeBtn) activeBtn.classList.add("active");

            // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            const data = bookTexts[index];
            if (data) {
                if (chapterLabel) chapterLabel.textContent = data.label;
                if (chapterTitle) chapterTitle.textContent = data.title;

                if (chapterList) {
                    chapterList.innerHTML = "";
                    data.lines.forEach((text) => {
                        const li  = document.createElement("li");
                        const dot = document.createElement("span");
                        dot.className = "chapter-dot";
                        li.appendChild(dot);
                        li.appendChild(document.createTextNode(" " + text));
                        chapterList.appendChild(li);
                    });
                }
            }

            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
            bookVideo.pause();
            const source = bookVideo.querySelector("source");
            source.src = bookVideos[index];
            bookVideo.load();
            if (autoplay) {
                bookVideo.play().catch(() => {});
            }
        }

        tabButtons.forEach((btn) => {
            btn.addEventListener("click", () => {
                playClick();
                playSound(pageflipSound);   // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏•‡∏¥‡∏Å‡∏´‡∏ô‡πâ‡∏≤
                const vidIndex = parseInt(btn.getAttribute("data-vid"), 10);
                setBookVideo(vidIndex, true);
            });
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà
        function resetExperience() {
            // ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            stopAllSongs();

            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™
            inputCode = "";
            updateCodeDisplay();

            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏Ñ‡πâ‡∏Å
            if (cake) {
                cake.classList.remove("blown");
            }

            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç
            if (giftBox) {
                giftBox.classList.remove("opened", "shake");
            }
            if (giftContent) {
                giftContent.classList.remove("show");
            }

            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏°‡∏∏‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥
            if (bookVideo) {
                bookVideo.pause();
                bookVideo.currentTime = 0;
            }
            setBookVideo(0, false);  // ‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ 1 ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡πÑ‡∏•‡∏î‡πå‡πÇ‡∏ä‡∏ß‡πå
            if (memoryIntervalId) {
                clearInterval(memoryIntervalId);
            }
            memoryIntervalId = null;
            memorySlideStarted = false;
            memoryIndex = 0;
            if (memoryImage) {
                memoryImage.classList.remove("show");
                memoryImage.src = memoryImages[0];
            }
        }

        if (replayBtn) {
            replayBtn.addEventListener("click", () => {
                playClick();
                resetExperience();
                goToPage(1);
            });
        }

        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤ 1 ‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î (‡πÑ‡∏°‡πà autoplay)
        setBookVideo(0, false);

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ 1
        goToPage(1);
    </script>
</body>
</html>
